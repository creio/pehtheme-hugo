{{ $flexSearch := resources.Get "js/flexsearch.bundle.min.js" -}}
{{ $slice := slice $flexSearch -}}

{{ $insertoggle := resources.Get "js/insertoggle.js" -}}
{{ $slice = $slice | append $insertoggle -}}

{{ $indexTemplate := resources.Get "js/index.js" -}}
{{ $index := $indexTemplate | resources.ExecuteAsTemplate "index.js" . -}}

{{ $js := $slice | resources.Concat "main.js" -}}

{{- if eq hugo.Environment "development" }}

  <script src="{{ $js.RelPermalink }}" defer></script>
  <script src="{{ $index.Permalink }}" defer></script>

{{- else }}
  {{ $js := $js | minify | fingerprint "sha512" -}}
  {{ $index := $index | minify | fingerprint "sha512" -}}

  <script src="{{ $js.RelPermalink }}" integrity="{{ $js.Data.Integrity }}" crossorigin="anonymous" defer></script>
  <script src="{{ $index.Permalink }}" integrity="{{ $index.Data.Integrity }}" crossorigin="anonymous" defer></script>

{{- end }}